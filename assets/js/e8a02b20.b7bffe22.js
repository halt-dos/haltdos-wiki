/*! For license information please see e8a02b20.b7bffe22.js.LICENSE.txt */
"use strict";(self.webpackChunkhaltdos_wiki=self.webpackChunkhaltdos_wiki||[]).push([[52481],{844:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"kb/waf/kb-1070","title":"KB: 1070","description":"How to decrypt SSL/TLS traffic using Wireshark and private keys?","source":"@site/docs/kb/waf/kb-1070.md","sourceDirName":"kb/waf","slug":"/kb/waf/kb-1070","permalink":"/kb/waf/kb-1070","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":70,"frontMatter":{"sidebar_position":70},"sidebar":"kb_sidebar","previous":{"title":"KB: 1069","permalink":"/kb/waf/kb-1069"},"next":{"title":"KB: 1071","permalink":"/kb/waf/kb-1071"}}');var i=r(74848),t=r(28453);const o={sidebar_position:70},l="KB: 1070",d={},c=[{value:"<strong>How to decrypt SSL/TLS traffic using Wireshark and private keys?</strong>",id:"how-to-decrypt-ssltls-traffic-using-wireshark-and-private-keys",level:4},{value:"Pre-Requisites",id:"pre-requisites",level:4},{value:"Steps",id:"steps",level:4}];function a(e){const n={admonition:"admonition",h1:"h1",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"kb-1070",children:"KB: 1070"})}),"\n",(0,i.jsx)(n.h4,{id:"how-to-decrypt-ssltls-traffic-using-wireshark-and-private-keys",children:(0,i.jsx)(n.strong,{children:"How to decrypt SSL/TLS traffic using Wireshark and private keys?"})}),"\n",(0,i.jsx)(n.h4,{id:"pre-requisites",children:"Pre-Requisites"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Wireshark software"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Private Key:"})," You need the private key of the server used in the SSL/TLS connection. This method only works for protocols like HTTPs where you have access to the private key."]}),"\n",(0,i.jsx)(n.li,{children:"The RSA private key file is in PEM format."}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{title:"Note",type:"note",children:(0,i.jsx)(n.p,{children:"Wireshark primarily supports RSA private keys for decrypting SSL/TLS traffic. However,You cannot decrypt Diffie-Hellman Ephemeral (DHE) key exchanges. Therefore, traffic using these ciphers will not be decoded."})}),"\n",(0,i.jsx)(n.h4,{id:"steps",children:"Steps"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Load the Captured File"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Open Wireshark and load your .pacp"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Configure the SSL/TLS Preferences"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.strong,{children:"Edit > Preferences"})]}),"\n",(0,i.jsx)(n.li,{children:"Expand the protocols list on the left side."}),"\n",(0,i.jsx)(n.li,{children:"Scroll down and select TLS or SSL (depending on your Wireshark version)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"kb-1070",src:r(87672).A+"",width:"794",height:"613"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Add the Private key"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"In the same preferences window under TLS or SSL, find the RSA keys list."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Click on the Edit button"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Add a new entry with the following details:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"IP address:"})," The IP adress of the server."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Port:"}),"  The port number(e.g, 443 for HTTPS)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Protocol:"})," Typically, HTTP"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Key File:"})," Browse and select the server's private key file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Password:"}),"  If the key file is encrypted, enter the password."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"kb-1070",src:r(1759).A+"",width:"794",height:"613"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"View Decrypted Data"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Wireshark should now automatically decrypt the SSL/TLS traffic using the private key."}),"\n",(0,i.jsx)(n.li,{children:"You can inspect the decrypted packets, including HTTP requests and responses, directly in Wireshark     ."}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},21020:(e,n,r)=>{var s=r(96540),i=Symbol.for("react.element"),t=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function c(e,n,r){var s,t={},c=null,a=null;for(s in void 0!==r&&(c=""+r),void 0!==n.key&&(c=""+n.key),void 0!==n.ref&&(a=n.ref),n)o.call(n,s)&&!d.hasOwnProperty(s)&&(t[s]=n[s]);if(e&&e.defaultProps)for(s in n=e.defaultProps)void 0===t[s]&&(t[s]=n[s]);return{$$typeof:i,type:e,key:c,ref:a,props:t,_owner:l.current}}n.Fragment=t,n.jsx=c,n.jsxs=c},74848:(e,n,r)=>{e.exports=r(21020)},1759:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/rsa-key-5eaee91766a670e9072f16db58ee91a6.png"},87672:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/tls-b71bb127ea8507936d142666bf6b5e91.png"},28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var s=r(96540);const i={},t=s.createContext(i);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);