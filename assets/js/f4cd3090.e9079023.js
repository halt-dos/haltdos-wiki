/*! For license information please see f4cd3090.e9079023.js.LICENSE.txt */
"use strict";(self.webpackChunkhaltdos_wiki=self.webpackChunkhaltdos_wiki||[]).push([[38910],{85264:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"cloud/waf/listener/rules/header_rules","title":"Header Rules","description":"Helps to modify headers, cookies, and arguments in the request sent to the back-end server as well as modifying response sent to the client.","source":"@site/versioned_docs/version-7.0/cloud/waf/listener/rules/header_rules.md","sourceDirName":"cloud/waf/listener/rules","slug":"/cloud/waf/listener/rules/header_rules","permalink":"/v7/cloud/waf/listener/rules/header_rules","draft":false,"unlisted":false,"tags":[],"version":"7.0","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"cloud_sidebar","previous":{"title":"Error Rules","permalink":"/v7/cloud/waf/listener/rules/error_rules"},"next":{"title":"Redirection Rules","permalink":"/v7/cloud/waf/listener/rules/redirection_rules"}}');var s=n(74848),i=n(28453);const l={sidebar_position:3},o="Header Rules",a={},d=[{value:"Overview",id:"overview",level:2},{value:"Content Security Policy Protection",id:"content-security-policy-protection",level:3},{value:"How to Use:",id:"how-to-use",level:3},{value:"Description",id:"description",level:4}];function c(e){const t={h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"header-rules",children:"Header Rules"})}),"\n",(0,s.jsx)(t.p,{children:"Helps to modify headers, cookies, and arguments in the request sent to the back-end server as well as modifying response sent to the client."}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(t.p,{children:"We have introduced Header rules by which application owners can manipulate request headers, cookies, and arguments in request as well as response headers. Users can create/update header rules at run time with on-the-fly updates. It has the functionality to add/remove/update any cookie/header/arguments in the request to the webserver(back-end) as well as respond to the client."}),"\n",(0,s.jsx)(t.h3,{id:"content-security-policy-protection",children:"Content Security Policy Protection"}),"\n",(0,s.jsx)(t.p,{children:"Content Security Policy (CSP) is an added layer of security that helps to detect and mitigate certain types of attacks, including Cross-Site Scripting (XSS), Skimming, Formjacking, Megacart and other data injection attacks. These attacks are used for everything from data theft, to site defacement, to malware distribution."}),"\n",(0,s.jsx)(t.p,{children:"Header rules can be used for enforcing Content Security Policy (CSP). They provide a simple and effective way to enfore CSP to allow approved domains from where scripts, images and other web resources can be loaded into the web page while blocking unapproved ones."}),"\n",(0,s.jsx)(t.h3,{id:"how-to-use",children:"How to Use:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Follow the links: ",(0,s.jsx)(t.strong,{children:"WAF > Zones > Listeners > Rules > Header Rules"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Click on ",(0,s.jsx)(t.strong,{children:"Add Rule"})," and set relevant parameters described below."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Click on ",(0,s.jsx)(t.strong,{children:"Save"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h4,{id:"description",children:"Description"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Rule Name"}),": Specify a rule name to identify the rule which is to be created. The rule name takes alpha-numeric input."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Message"}),": Specify a rule message containing a detailed description to identify the rule which is to be created."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Change Response"}),": This field determines that the rule will update the request or response. If the toggle is enabled the rule will be applicable to response and if it is disabled then the rule will be applicable to request."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"URI"}),": Specify the URI or regex for which rule will be applied."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Search Location"}),": This field determines whether the rule has to perform the action on headers/cookies/arguments value. The accepted values are:"]}),"\n",(0,s.jsx)(t.p,{children:"HEADER_VAL: Rule will be applicable on the header value in the request or response."}),"\n",(0,s.jsx)(t.p,{children:"COOKIE_VAL: Rule will be applicable to the cookie value in the request or response."}),"\n",(0,s.jsx)(t.p,{children:"AGRS_VAL: Rule will be applicable to the argument value in the request or response."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Rule Action"}),": The rule action determines what action (add/remove/overwrite) the rule will perform. The accepted values are:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"ADD: This condition will allow adding a value at the specified location."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"REMOVE: This condition will allow removing a value at the specified location."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"OVERWRITE: This condition will allow overwriting a value at the specified location."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["If the action is ",(0,s.jsx)(t.strong,{children:"ADD"})," then another field is required I.e., ",(0,s.jsx)(t.strong,{children:"Value"})," that will be added for the specified ",(0,s.jsx)(t.strong,{children:"Parameter"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["If the action is ",(0,s.jsx)(t.strong,{children:"REMOVE"}),", then the specified parameter is removed."]}),"\n",(0,s.jsxs)(t.p,{children:["If the action is ",(0,s.jsx)(t.strong,{children:"OVERWRITE"}),", then two other fields are required first is ",(0,s.jsx)(t.strong,{children:"Search Pattern"})," (string/regex that should match the existing value) and Replace (the string that should be overwritten). We can capture string from the PCRE capturing group using position with a prefix of '$'."]}),"\n",(0,s.jsx)(t.p,{children:"Note: In order to escape the dollar($) character in the replace, add the dollar symbol twice."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Parameter"}),": This field specifies the name of the header/cookie/ arguments on which action will be performed."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Add Condition"}),": The user can specify some request/response-based conditions which can be used as mandatory conditions to be fulfilled to apply the rule."]}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Condition Location"}),(0,s.jsx)(t.th,{children:"Search Location"}),(0,s.jsx)(t.th,{children:"Allowed"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Request"}),(0,s.jsx)(t.td,{children:"Request"}),(0,s.jsx)(t.td,{children:"True"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Request"}),(0,s.jsx)(t.td,{children:"Response"}),(0,s.jsx)(t.td,{children:"True"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Response"}),(0,s.jsx)(t.td,{children:"Response"}),(0,s.jsx)(t.td,{children:"True"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Response"}),(0,s.jsx)(t.td,{children:"Request"}),(0,s.jsx)(t.td,{children:"False"})]})]})]}),"\n",(0,s.jsx)(t.p,{children:"For adding a condition, the required fields are:"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Check Response"}),": This field determines that the condition will be checked on request/response parameters."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Search Location"}),": This field determines whether the condition should be checked on headers/cookies/arguments. The accepted values are:"]}),"\n",(0,s.jsx)(t.p,{children:"HEADER_VAL: Rule will be applicable on the header value in the request or response."}),"\n",(0,s.jsx)(t.p,{children:"COOKIE_VAL: Rule will be applicable to the cookie value in the request or response."}),"\n",(0,s.jsx)(t.p,{children:"AGRS_VAL: Rule will be applicable to the argument value in the request or response."}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Parameter"}),": This field specifies the name of the header/cookie/ arguments on which condition will be validated. Search Pattern: This field specifies the pattern that will be matched against the header/cookie/ argument value to satisfy the condition."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Search Pattern"}),": This field specifies the pattern that will be matched against the header/cookie/ argument value to satisfy the condition."]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},21020:(e,t,n)=>{var r=n(96540),s=Symbol.for("react.element"),i=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,n){var r,i={},d=null,c=null;for(r in void 0!==n&&(d=""+n),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)l.call(t,r)&&!a.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:s,type:e,key:d,ref:c,props:i,_owner:o.current}}t.Fragment=i,t.jsx=d,t.jsxs=d},74848:(e,t,n)=>{e.exports=n(21020)},28453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>o});var r=n(96540);const s={},i=r.createContext(s);function l(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);