"use strict";(self.webpackChunkhaltdos_wiki=self.webpackChunkhaltdos_wiki||[]).push([[46977],{3905:(e,t,r)=>{r.d(t,{Zo:()=>s,kt:()=>k});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var p=n.createContext({}),u=function(e){var t=n.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},s=function(e){var t=u(e.components);return n.createElement(p.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,l=e.originalType,p=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),m=u(r),c=a,k=m["".concat(p,".").concat(c)]||m[c]||d[c]||l;return r?n.createElement(k,o(o({ref:t},s),{},{components:r})):n.createElement(k,o({ref:t},s))}));function k(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=r.length,o=new Array(l);o[0]=c;var i={};for(var p in t)hasOwnProperty.call(t,p)&&(i[p]=t[p]);i.originalType=e,i[m]="string"==typeof e?e:a,o[1]=i;for(var u=2;u<l;u++)o[u]=r[u];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}c.displayName="MDXCreateElement"},89709:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>p,toc:()=>s});r(67294);var n=r(3905);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a.apply(this,arguments)}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}const o={sidebar_position:5},i="Variable Rules",p={unversionedId:"cloud/waf/listener/rules/variables_rules",id:"version-7.0/cloud/waf/listener/rules/variables_rules",title:"Variable Rules",description:"---",source:"@site/versioned_docs/version-7.0/cloud/waf/listener/rules/variables_rules.md",sourceDirName:"cloud/waf/listener/rules",slug:"/cloud/waf/listener/rules/variables_rules",permalink:"/cloud/waf/listener/rules/variables_rules",draft:!1,tags:[],version:"7.0",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"cloud_sidebar",previous:{title:"Redirection Rules",permalink:"/cloud/waf/listener/rules/redirection_rules"},next:{title:"Upstream rules",permalink:"/cloud/waf/listener/rules/upstream_rules"}},u={},s=[{value:"Overview",id:"overview",level:2},{value:"How to Use:",id:"how-to-use",level:3},{value:"Description",id:"description",level:4}],m={toc:s},d="wrapper";function c(e){var{components:t}=e,r=l(e,["components"]);return(0,n.kt)(d,a({},m,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",a({},{id:"variable-rules"}),"Variable Rules"),(0,n.kt)("hr",null),(0,n.kt)("h2",a({},{id:"overview"}),"Overview"),(0,n.kt)("p",null,"If a user wants to extract or set a custom variable, then it can be done using Variable Rules. It can be used in the following:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Form Validation: If a user wants a form field to be immutable, then he can create a variable for that field that is going to be immutable. This variable can be used in form validation to check whether the field is immutable or not. If the field is modified, then the request will be dropped.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},'Rate Limit: Assume if a user wants to rate limit on a variable then, it can be done by storing a parameter from the Request/Response. For example, the "User-Agent" header stored in the variable can be used for Rate Limit. '))),(0,n.kt)("p",null,"Note: Any parameter from the Request/Response can be stored in a variable."),(0,n.kt)("h3",a({},{id:"how-to-use"}),"How to Use:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Go to ",(0,n.kt)("strong",{parentName:"p"},"WAF > Zones > Listeners > Rules > Variable Rules"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Create rules with different conditions and ",(0,n.kt)("strong",{parentName:"p"},"Save Changes"),"."))),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",a({parentName:"tr"},{align:null}),"PARAMETERS"),(0,n.kt)("th",a({parentName:"tr"},{align:null}),"ACCEPTED VALUES"),(0,n.kt)("th",a({parentName:"tr"},{align:null}),"DEFAULT"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Rule Name"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"String"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"None")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Rule Message"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"String"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"None")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Rule Priority"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Integer"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"None")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",a({parentName:"tr"},{align:null}),"URI"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Existing server group"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"None")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Scope"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Choose from the dropdown"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"GLOBAL")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Variable Extraction"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Choose from the dropdown"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"SET")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Extraction Location"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Choose from the dropdown"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"None")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Parameter Cast"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Choose from the dropdown"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"String")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Variable Name"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"String"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"None")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",a({parentName:"tr"},{align:null}),"Parameter"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"String"),(0,n.kt)("td",a({parentName:"tr"},{align:null}),"None")))),(0,n.kt)("h4",a({},{id:"description"}),"Description"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Rule Name")),(0,n.kt)("p",null,"Specify a user-friendly name to identify the rule. The rule name takes alpha-numeric input."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Message")," "),(0,n.kt)("p",null,"The user can add a short description of the rule. The description would explain the purpose of the rule."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Rule Priority")," "),(0,n.kt)("p",null,"Set the priority of the rule. If two rules have the same priority, then selection will be random."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"URI")," "),(0,n.kt)("p",null,"Enter the match URI for the rule. Any request coming to the specified URI will invoke this rule.   "),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Scope")," "),(0,n.kt)("p",null,"Select the scope where the rule will be applicable like Global/Transaction/Session. "),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Variable Extraction")," "),(0,n.kt)("p",null,"Select from the dropdown like Set/Mutate/Request/Response."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Extraction Location")," "),(0,n.kt)("p",null,"Select the location from the dropdown like for Request Variables: URL, Header value, Cookie value, Body value, Body, Arguments value, and for Response Variables: Header value, Body."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Parameter Cast")," "),(0,n.kt)("p",null,"Select the type of parameter from the dropdown like String, Integer, XML, JSON, HTML. This defines the specific type of parameter for which the rule will be applicable."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Variable Name")," "),(0,n.kt)("p",null,"Enter the name of the variable to be set. The variable defined will be applicable for the rule."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Parameter")," "),(0,n.kt)("p",null,"Enter the parameter name to be used for Variable extraction."))}c.isMDXComponent=!0}}]);