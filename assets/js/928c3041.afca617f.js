"use strict";(self.webpackChunkhaltdos_wiki=self.webpackChunkhaltdos_wiki||[]).push([[95804],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>f});var n=r(67294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var l=n.createContext({}),u=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},p=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},v=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=u(r),v=i,f=c["".concat(l,".").concat(v)]||c[v]||d[v]||a;return r?n.createElement(f,o(o({ref:t},p),{},{components:r})):n.createElement(f,o({ref:t},p))}));function f(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=r.length,o=new Array(a);o[0]=v;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:i,o[1]=s;for(var u=2;u<a;u++)o[u]=r[u];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}v.displayName="MDXCreateElement"},12705:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>v,frontMatter:()=>o,metadata:()=>l,toc:()=>p});r(67294);var n=r(3905);function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(this,arguments)}function a(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}const o={sidebar_position:3},s="Antivirus",l={unversionedId:"cloud/waf/listener/profiles/anti_virus",id:"cloud/waf/listener/profiles/anti_virus",title:"Antivirus",description:"Get your files scanned before you upload them using antivirus",source:"@site/docs/cloud/waf/listener/profiles/anti_virus.md",sourceDirName:"cloud/waf/listener/profiles",slug:"/cloud/waf/listener/profiles/anti_virus",permalink:"/v8/cloud/waf/listener/profiles/anti_virus",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"cloud_sidebar",previous:{title:"Geo Filtering",permalink:"/v8/cloud/waf/listener/profiles/geo_filtering"},next:{title:"Bot Protection",permalink:"/v8/cloud/waf/listener/profiles/bot"}},u={},p=[{value:"Overview",id:"overview",level:2},{value:"Antivirus Mode",id:"antivirus-mode",level:3},{value:"How To Use:",id:"how-to-use",level:3},{value:"Description",id:"description",level:3},{value:"<strong>Antivirus Mode</strong>",id:"antivirus-mode-1",level:5},{value:"<strong>ICAP Server IP</strong>",id:"icap-server-ip",level:5},{value:"<strong>ICAP Server Port</strong>",id:"icap-server-port",level:5},{value:"<strong>ICAP Service Name</strong>",id:"icap-service-name",level:5},{value:"<strong>ICAP Method</strong>",id:"icap-method",level:5},{value:"<strong>ICAP Request Timeout</strong>",id:"icap-request-timeout",level:5},{value:"<strong>ICAP Header Name</strong>",id:"icap-header-name",level:5},{value:"<strong>ICAP Header Value</strong>",id:"icap-header-value",level:5}],c={toc:p},d="wrapper";function v(e){var{components:t}=e,o=a(e,["components"]);return(0,n.kt)(d,i({},c,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",i({},{id:"antivirus"}),"Antivirus"),(0,n.kt)("p",null,"Get your files scanned before you upload them using antivirus"),(0,n.kt)("h2",i({},{id:"overview"}),"Overview"),(0,n.kt)("p",null,"Our WAF provides the facility of in-built antivirus. Also, the user can set up their own antivirus and use it with hdPlatform. If someone tries to upload a malicious file, then AV scan will stop it from getting uploaded and will generate an event as AV Scan drops."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Antivirus",src:r(26895).Z,width:"1910",height:"900"})),(0,n.kt)("h3",i({},{id:"antivirus-mode"}),"Antivirus Mode"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Disabled"),": Files will not get scanned if the mode is disabled."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Internal"),": In-built antivirus will be used to scan files."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"External"),": If an ICAP (Internet Content Adaptation Protocol) server is already configured for antivirus, then it can be used by providing the details on this screen."),(0,n.kt)("h3",i({},{id:"how-to-use"}),"How To Use:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Go to ",(0,n.kt)("strong",{parentName:"li"},"WAF")," > ",(0,n.kt)("strong",{parentName:"li"},"Listener")," > ",(0,n.kt)("strong",{parentName:"li"},"Profiles")," > ",(0,n.kt)("strong",{parentName:"li"},"Antivirus")),(0,n.kt)("li",{parentName:"ol"},"Configure your setting "),(0,n.kt)("li",{parentName:"ol"},"Click on ",(0,n.kt)("strong",{parentName:"li"},"Save Changes"))),(0,n.kt)("h3",i({},{id:"description"}),"Description"),(0,n.kt)("h5",i({},{id:"antivirus-mode-1"}),(0,n.kt)("strong",{parentName:"h5"},"Antivirus Mode")),(0,n.kt)("p",null,"This field specifies the mode for antivirus scan against all uploaded files (if any). There are three modes for Antivirus: Disabled, Internal, External."),(0,n.kt)("pre",null,(0,n.kt)("code",i({parentName:"pre"},{}),"Accepted values: DISABLED / INTERNAL / EXTERNAL\n\nDefault: DISABLED  \n")),(0,n.kt)("h5",i({},{id:"icap-server-ip"}),(0,n.kt)("strong",{parentName:"h5"},"ICAP Server IP")),(0,n.kt)("p",null,"If we use External Antivirus mode then an ICAP server is configured for antivirus, then it can be used by providing the IP address for the ICAP server to send requests for antivirus scans."),(0,n.kt)("pre",null,(0,n.kt)("code",i({parentName:"pre"},{}),"Accepted values: IP\n\nDefault: Blank  \n")),(0,n.kt)("h5",i({},{id:"icap-server-port"}),(0,n.kt)("strong",{parentName:"h5"},"ICAP Server Port")),(0,n.kt)("p",null,"The client initiates the session by sending request messages over a TCP/IP connection to a passively waiting ICAP server on a designated port. For External Antivirus mode, We need to specify the ICAP server port to connect (Port 1344 is the default ICAP port)."),(0,n.kt)("pre",null,(0,n.kt)("code",i({parentName:"pre"},{}),"Accepted values: Port\n\nDefault: 1334  \n")),(0,n.kt)("h5",i({},{id:"icap-service-name"}),(0,n.kt)("strong",{parentName:"h5"},"ICAP Service Name")),(0,n.kt)("p",null,"For External Antivirus mode, We need to specify the name of the ICAP service to scan against antivirus."),(0,n.kt)("pre",null,(0,n.kt)("code",i({parentName:"pre"},{}),"Accepted values: icap://< ip_address >/< name >/\n\nDefault: Blank\n")),(0,n.kt)("h5",i({},{id:"icap-method"}),(0,n.kt)("strong",{parentName:"h5"},"ICAP Method")),(0,n.kt)("p",null,"For External Antivirus mode, We need to specify the ICAP request method for antivirus scanning. In REQMOD mode, the ICAP request MUST contain an encapsulated HTTP request."),(0,n.kt)("pre",null,(0,n.kt)("code",i({parentName:"pre"},{}),"Accepted values: Specify the request method for antivirus scanning.\n\nDefault: REQMOD \n")),(0,n.kt)("h5",i({},{id:"icap-request-timeout"}),(0,n.kt)("strong",{parentName:"h5"},"ICAP Request Timeout")),(0,n.kt)("p",null,"For External Antivirus mode, We need to specify the timeout in milliseconds for request timeout. If an ICAP request has not been completed before the timeout, the connection to the client gets closed."),(0,n.kt)("pre",null,(0,n.kt)("code",i({parentName:"pre"},{}),"Accepted values: Integer\n\nDefault: 800  \n\nMetrics: milliSeconds\n")),(0,n.kt)("h5",i({},{id:"icap-header-name"}),(0,n.kt)("strong",{parentName:"h5"},"ICAP Header Name")),(0,n.kt)("p",null,"For External Antivirus mode, We need to specify the ICAP header key to search value against it. The request line specifies the ICAP resource that is being requested. Header fields follow with information, such as cache control and preview size. The header fields end with a blank line followed by the message body."),(0,n.kt)("pre",null,(0,n.kt)("code",i({parentName:"pre"},{}),"Accepted values: String (HEADER NAME)\n\nDefault: Blank  \n")),(0,n.kt)("h5",i({},{id:"icap-header-value"}),(0,n.kt)("strong",{parentName:"h5"},"ICAP Header Value")),(0,n.kt)("p",null,"For External Antivirus mode, We need to specify the ICAP header value regex to scan and drop if the key exists."),(0,n.kt)("pre",null,(0,n.kt)("code",i({parentName:"pre"},{}),"Accepted values: String\n\nDefault: Blank\n")))}v.isMDXComponent=!0},26895:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/antivirus-67ed932f3e16469131b4bbde25abb80b.png"}}]);