/*! For license information please see c643ec63.034245bf.js.LICENSE.txt */
"use strict";(self.webpackChunkhaltdos_wiki=self.webpackChunkhaltdos_wiki||[]).push([[78306],{82401:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>h,contentTitle:()=>l,default:()=>d,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"kb/waf/kb-1071","title":"KB: 1071","description":"How to decrypt SSL/TLS using Wireshark and SSLKEYLOGFILE environment variable on Firefox or Google Chrome using Wireshark?","source":"@site/docs/kb/waf/kb-1071.md","sourceDirName":"kb/waf","slug":"/kb/waf/kb-1071","permalink":"/kb/waf/kb-1071","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":71,"frontMatter":{"sidebar_position":71},"sidebar":"kb_sidebar","previous":{"title":"KB: 1070","permalink":"/kb/waf/kb-1070"},"next":{"title":"KB: 1072","permalink":"/kb/waf/kb-1072"}}');var r=n(74848),o=n(28453);const t={sidebar_position:71},l="KB: 1071",h={},c=[{value:"<strong>How to decrypt SSL/TLS using Wireshark and SSLKEYLOGFILE environment variable on Firefox or Google Chrome using Wireshark?</strong>",id:"how-to-decrypt-ssltls-using-wireshark-and-sslkeylogfile-environment-variable-on-firefox-or-google-chrome-using-wireshark",level:4},{value:"Pre-Requisites",id:"pre-requisites",level:4},{value:"How to log the SSL session keys on windows",id:"how-to-log-the-ssl-session-keys-on-windows",level:5},{value:"How to log the SSL session keys on Linux",id:"how-to-log-the-ssl-session-keys-on-linux",level:5},{value:"How to decrypt SSL/TLS traffic using Wireshark with SSLKEYLOGFILE",id:"how-to-decrypt-ssltls-traffic-using-wireshark-with-sslkeylogfile",level:4},{value:"Steps",id:"steps",level:4}];function a(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h4:"h4",h5:"h5",header:"header",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"kb-1071",children:"KB: 1071"})}),"\n",(0,r.jsx)(s.h4,{id:"how-to-decrypt-ssltls-using-wireshark-and-sslkeylogfile-environment-variable-on-firefox-or-google-chrome-using-wireshark",children:(0,r.jsx)(s.strong,{children:"How to decrypt SSL/TLS using Wireshark and SSLKEYLOGFILE environment variable on Firefox or Google Chrome using Wireshark?"})}),"\n",(0,r.jsx)(s.h4,{id:"pre-requisites",children:"Pre-Requisites"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Wireshark Software"}),"\n",(0,r.jsx)(s.li,{children:"Firefox or Chrome browsers to access the web application"}),"\n"]}),"\n",(0,r.jsx)(s.h5,{id:"how-to-log-the-ssl-session-keys-on-windows",children:"How to log the SSL session keys on windows"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Open the Environment Variables by right-clicking on ",(0,r.jsx)(s.strong,{children:"This PC"})," and selecting ",(0,r.jsx)(s.strong,{children:"Properties"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Click on ",(0,r.jsx)(s.strong,{children:"Advanced system settings"})," on the left."]}),"\n",(0,r.jsxs)(s.li,{children:["In the System Properties window, click on the ",(0,r.jsx)(s.strong,{children:"Environment Variables"})," button."]}),"\n",(0,r.jsxs)(s.li,{children:["Under ",(0,r.jsx)(s.strong,{children:"System variables"}),', click "New".']}),"\n",(0,r.jsxs)(s.li,{children:["In the ",(0,r.jsx)(s.strong,{children:"Variable name"})," field, enter ",(0,r.jsx)(s.code,{children:"SSLKEYLOGFILE"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["In the ",(0,r.jsx)(s.strong,{children:"Variable value"})," field, enter the path where you want the SSL keys to be saved, e.g., ",(0,r.jsx)(s.code,{children:"C:\\path\\to\\sslkeys.log"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Select ",(0,r.jsx)(s.strong,{children:"OK"})]}),"\n",(0,r.jsx)(s.li,{children:"Start Firefox or Chrome"}),"\n",(0,r.jsx)(s.li,{children:"Access the web application.Now, whenever you visit the application using SSL/TLS, the session keys will be logged to the specified file."}),"\n"]}),"\n",(0,r.jsx)(s.h5,{id:"how-to-log-the-ssl-session-keys-on-linux",children:"How to log the SSL session keys on Linux"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Open a terminal"}),"\n",(0,r.jsxs)(s.li,{children:["Set the SSLKEYLOGFILE environment variable for your account by using the following command syntax: ",(0,r.jsx)("br",{}),(0,r.jsx)(s.code,{children:'export SSLKEYLOGFILE="/path/to/logfile/sslkeyfile'}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{})," For example: ",(0,r.jsx)("br",{})," ",(0,r.jsx)(s.code,{children:'export SSLKEYLOGFILE="/home/test/sslkeyfile.log'})]}),"\n",(0,r.jsxs)(s.li,{children:["Start packet capture using an application such as Wireshark or ",(0,r.jsx)(s.strong,{children:"tcpdump"}),". For information about ",(0,r.jsx)(s.strong,{children:"tcpdump"})," refer to ",(0,r.jsx)(s.a,{href:"/kb/waf/kb-1069",children:"How to capture packet and tracethem through tcp dump utility?"})]}),"\n",(0,r.jsxs)(s.li,{children:["Start Firefox or Chrome from the same terminal ",(0,r.jsx)("br",{})," ",(0,r.jsx)("br",{}),"\nFor example\n",(0,r.jsx)(s.code,{children:"google-chrome"})]}),"\n"]}),"\n",(0,r.jsx)(s.admonition,{title:"Note",type:"note",children:(0,r.jsx)(s.p,{children:"You must start the browser from the same command terminal beacause the session variable is set only on the terminal"})}),"\n",(0,r.jsxs)(s.ol,{start:"5",children:["\n",(0,r.jsx)(s.li,{children:"Access the web application.Now, whenever you visit the application using SSL/TLS, the session keys will be logged to the specified file."}),"\n"]}),"\n",(0,r.jsx)(s.h4,{id:"how-to-decrypt-ssltls-traffic-using-wireshark-with-sslkeylogfile",children:"How to decrypt SSL/TLS traffic using Wireshark with SSLKEYLOGFILE"}),"\n",(0,r.jsx)(s.h4,{id:"steps",children:"Steps"}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Load the Captured File"})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Open Wireshark and load your .pacp"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Configure the SSL/TLS Preferences"})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["Go to ",(0,r.jsx)(s.strong,{children:"Edit > Preferences"})]}),"\n",(0,r.jsx)(s.li,{children:"Expand the protocols list on the left side."}),"\n",(0,r.jsx)(s.li,{children:"Scroll down and select TLS or SSL (depending on your Wireshark version)"}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"kb-1070",src:n(87672).A+"",width:"794",height:"613"})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Set the Pre-Master Secret Log File"})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["In the ",(0,r.jsx)(s.strong,{children:"Pre-Master-Secret log filename"})," field, click ",(0,r.jsx)(s.strong,{children:"Browse"})," and select the sslkeys.log file that your browser has been writing to."]}),"\n",(0,r.jsxs)(s.li,{children:["Apply the settings by clicking ",(0,r.jsx)(s.strong,{children:"OK"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"View Decrypted Data"})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Wireshark should now automatically decrypt the SSL/TLS traffic using the session keys from sslkeys.log"}),"\n",(0,r.jsx)(s.li,{children:"You can inspect the decrypted packets, including HTTP requests and responses, directly in Wireshark"}),"\n"]}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},21020:(e,s,n)=>{var i=n(96540),r=Symbol.for("react.element"),o=Symbol.for("react.fragment"),t=Object.prototype.hasOwnProperty,l=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h={key:!0,ref:!0,__self:!0,__source:!0};function c(e,s,n){var i,o={},c=null,a=null;for(i in void 0!==n&&(c=""+n),void 0!==s.key&&(c=""+s.key),void 0!==s.ref&&(a=s.ref),s)t.call(s,i)&&!h.hasOwnProperty(i)&&(o[i]=s[i]);if(e&&e.defaultProps)for(i in s=e.defaultProps)void 0===o[i]&&(o[i]=s[i]);return{$$typeof:r,type:e,key:c,ref:a,props:o,_owner:l.current}}s.Fragment=o,s.jsx=c,s.jsxs=c},74848:(e,s,n)=>{e.exports=n(21020)},87672:(e,s,n)=>{n.d(s,{A:()=>i});const i=n.p+"assets/images/tls-b71bb127ea8507936d142666bf6b5e91.png"},28453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>l});var i=n(96540);const r={},o=i.createContext(r);function t(e){const s=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(o.Provider,{value:s},e.children)}}}]);