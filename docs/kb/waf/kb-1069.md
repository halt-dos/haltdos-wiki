---
sidebar_position: 69
---

# KB: 1069

#### **How to capture packet and trace them through tcp dump utility?**

Haltdos WAF receives incoming requests from the internet, decrypts the
content for inspection, and analyzes the traffic for potential security
threats. After performing the necessary security checks and filtering,
it re-encrypts the data and forwards it securely to the backend server
for further processing.

Below is the command to run the tcp dump utility-

**Command: -** 

    tcpdump -i <interface> port <port> -w <filename>.pcap


**Arguments: -**

   1. **`-i <interface>`:** Specifies the network interface to listen on.

   2. **`host <hostname>`**: Captures packets to or from a specific host.

   3. **`port <port>`**: Captures packets to or from a specific port.

   4. **`-w <file>`**: Writes the captured packets to a file instead of
    displaying them on the screen.

   5. **-A**: Displays the packet contents in ASCII, which is useful for
    inspecting HTTP requests or other text-based protocols

   6. **-X**: Displays the packet contents in both hex and ASCII.

To see the decrypted content, you can use a tool like Wireshark. To
decrypt encrypted traffic captured in a dump file using Wireshark, you
need specific keys or passwords depending on the encryption protocol
used (e.g., SSL/TLS). Below are the reference documents decrypting SSL/TLS
traffic in Wireshark.

Reference 1: [How to decrypt SSL/TLS traffic using Wireshark and private keys?](./kb-1071.md)

Reference 2: [How to decrypt SSL/TLS using Wireshark and SSLKEYLOGFILE environment variable on Firefox or Google Chrome using Wireshark?](./kb-1072.md) 